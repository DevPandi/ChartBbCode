((n,g)=>{XF.DevPandi=XF.DevPandi||{};class e{constructor(a,b){this.chartData=a;this.id=this.chartData.id;this.type=this.chartData.type;this.chartBox=g.getElementById("chart-"+this.id);this._readOptions();this._readData()}_readOptions(){this.options=this._getDefaultOptions();this.chartData.title&&(this.options.plugins.title={display:!0,text:this.chartData.title})}_readData(){this.data={labels:this._readXElements(),datasets:this._readYElements()}}_readYElements(){let a=[],b=0,c=this._readYElement;this.chartData.y.forEach(function(d){a[b]=
c(d);b++});return a}_readYElement(a){let b={};b.label=a.name;a.color&&(b.backgroundColor=[a.color]);a.border&&(b.borderColor=[a.border]);b.data=a.data;return b}_readXElements(){return this.chartData.x?this.chartData.x:[]}_getDefaultOptions(){return{plugins:{legend:{position:"bottom"}},responsive:!0,elements:{bar:{borderWidth:2}}}}}class h extends e{_readOptions(){super._readOptions();this.options.scales={};this.chartData.useX?(this.options.indexAxis="y",this.options.scales.x=this._readOptionsAxis()):
this.options.scales.y=this._readOptionsAxis()}_readOptionsAxis(){let a={};0<this.chartData.min?a.min=this.chartData.min:a.beginAtZero=!0;this.chartData.max&&(a.max=this.chartData.max);if(!this.chartData.y_axis.tick&&this.chartData.y_axis.str)a.title={display:!0,text:this.chartData.y_axis.str};else{a.ticks={};let b=this.chartData.y_axis.str;a.ticks.callback=this.chartData.y_axis.start?function(c,d,f){return c+b}:function(c,d,f){return b+c}}return a}}class k extends e{_readYElement(a){let b=super._readYElement(a);
a.dashed&&(b.borderDash=[5,5]);a.point&&(b.pointStyle=a.point.style,b.pointRadius=a.point.size,b.pointHoverRadius=a.point.size+5);a.border||(b.borderColor=[a.color]);return b}_readOptions(){super._readOptions();this.options.scales={};this.options.scales.y=this._readOptionsAxis();this.chartData.x_axis&&(this.options.scales.x={title:{display:!0,text:this.chartData.x_axis}})}_readOptionsAxis(){let a={};0<this.chartData.min?a.min=this.chartData.min:a.beginAtZero=!0;this.chartData.max&&(a.max=this.chartData.max);
if(!this.chartData.y_axis.tick&&this.chartData.y_axis.str)a.title={display:!0,text:this.chartData.y_axis.str};else{a.ticks={};let b=this.chartData.y_axis.str;a.ticks.callback=this.chartData.y_axis.start?function(c,d,f){return c+b}:function(c,d,f){return b+c}}return a}}class l extends e{_readData(){this.data={labels:this.chartData.labels,datasets:[]};this.data.datasets[0]={data:this.chartData.elements.data,backgroundColor:this.chartData.elements.color,borderColor:["transparent"]}}}class m{constructor(){this.charts=
[]}getChart(a){switch(a.type){case "bar":return new h(a);case "line":return new k(a);case "pie":return new l(a)}}renderCharts(){let a=g.getElementsByClassName("chartBbcodeData");for(var b=0;b<a.length;b++)this.renderChart(JSON.parse(a[b].textContent))}renderChart(a){!this.charts[a.id]&&(a=this.getChart(a))&&(this.charts[a.id]=a,new Chart(a.chartBox,{type:a.type,data:a.data,options:a.options}))}}XF.DevPandi.ChartBbCode=new m;XF.DevPandi.ChartBbCode.renderCharts();XF.Element.extend("quick-reply",{__backup:{afterSubmit:"_afterSubmitExtension"},
afterSubmit:function(a,b){this._afterSubmitExtension(a,b);XF.DevPandi.ChartBbCode.renderCharts()}});XF.Element.extend("quick-edit",{__backup:{editSubmit:"_editSubmit"},editSubmit:function(a){this._editSubmit(a);XF.DevPandi.ChartBbCode.renderCharts()}});XF.Element.extend("message-loader",{__backup:{loaded:"_loaded"},loaded:function(a){this._loaded(a);XF.DevPandi.ChartBbCode.renderCharts()}})})(window,document);
